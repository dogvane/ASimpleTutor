# 知识点浏览与搜索

## 1. 交互界面

### 1.1 侧边栏：混合目录树 (Hybrid Table of Contents)

系统采用结构+概念的混合树形展示：
- **Lv1~N (Folder/File)**: 对应的书籍物理目录和文档章节标题。
- **Leaf (Tag/Concept)**: 挂载在章节下的具体知识点 (Concept KPs)。

**状态指示**：
- 节点旁显示掌握度圆环 (Mastery Ring)。
- 颜色区分：灰色(未开始)、蓝色(学习中)、绿色(已掌握)。

### 1.2 主搜索框 (Global Search)

位于顶部导航栏，支持自然语言查询。

## 2. 搜索策略 (Hybrid Search)

### 2.1 索引层

- **Keyword Index**: 传统的倒排索引（基于 SQLite FTS 或内存反向索引），匹配 KP 标题、别名、原文文本。
- **Vector Index**: 向量索引，匹配语义相关的 Chunks。

### 2.2 检索流程

1.  **用户输入 Query**。
2.  **并行检索**：
    - **关键词匹配**：查找标题匹配的 KP。
    - **向量检索**：将 Query 向量化，在 RAG Index 中查找 Top K 相关 Chunks。
3.  **结果融合 (Rerank)**：
    - 优先展示标题完全匹配的 KP。
    - 其次展示语义高度相关的 KP。
    - 最后展示相关的原文段落 (Snippets)。

## 3. 关联推荐

在 Slide 模式下，特定页面（如 Deep Dive 页或章节总结页）会展示：
- **学习路径建议**：基于前置/后置关系推荐下一个 KP。
- **相关概念**：基于向量相似度推荐全书中相关的其他 KP，点击即可跳转至对应 Slide。

## 4. 详细页交互 (Slide Navigation)

- **定位逻辑**：
    - 搜索结果点击后，主视图直接加载目标 KP 的 **First Slide (Cover)**。
    - 同时左侧目录树自动展开并高亮定位到该 KP 节点。
- **上下文保持**：
    - 如果用户正在播放一个长章节列表，搜索跳转会打断当前播放队列，加载新的单点队列。
    - 提供返回按钮回到之前的播放上下文。
