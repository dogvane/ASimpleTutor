# 学习内容生成（精要速览 / 原文对照 / 层次化展开）（MVP）

## 1. 功能目标

用户选择知识点后，提供从“快速理解”到“结合原文掌握”的学习体验：

- 精要速览：定义/要点/常见误区
- 原文对照：展示相关原始段落
- 层次化展开：概览 → 详细 → 深入
- 关联拓展（可选）：相关知识点一键跳转

## 2. 输入与输出

### 输入

- `kp_id`
- `KnowledgeSystem`
- KP 关联证据片段 `snippets[]`

### 输出：LearningPack

- `summary`：精要速览
- `levels`：分层内容（3 层以内）
- `snippet_ids`：原文片段引用（带出处信息可由 UI 展开显示）
- `related_kps`（可选）

## 3. 原文对照

### 3.1 片段选择

- 优先使用知识构建阶段绑定的 `snippets[]`
- 若片段过长：
  - 截取关键段落（保留上下文 1 段）
- 若片段过少：
  - 基于 KP 标题/别名在文档中做关键词检索补充

### 3.2 出处信息

每个片段至少包含：

- 文件名
- 章节标题路径
- 片段内容

## 4. 精要速览

### 4.1 内容结构

- 定义（1~3 句）
- 核心要点（3~7 条）
- 常见误区（1~3 条）

### 4.2 生成原则

- 只基于证据片段与书内上下文，不引入外部事实（除非明确允许）。
- 若证据不足：明确标注“不确定/书中未明确”。

## 5. 层次化展开

### 5.1 层级定义

- L1 概览：面向“第一次接触”
- L2 详细：解释关键机制/步骤/例子
- L3 深入：边界条件/对比/推导（MVP 可选）

### 5.2 UI 交互

- 默认展开 L1
- 用户点击“展开更多”显示 L2/L3

## 6. 关联拓展（可选）

- 来源：知识体系构建阶段的关联边
- 展示：最多 5 个，按关联类型/重要性排序

## 7. 深度探索（规划项：使用参考书目目录）

当用户对某知识点需要"更深入理解/扩展学习"时，可新增一个入口（例如按钮：深度探索）：

- 输入：`kp_id` + 主书证据片段 +（可选）用户提问
- 检索范围：Book Root 内的"参考书目目录"（Reference Library）下的 `.md`
- 输出：
  - 相关参考片段列表（必须带出处）
  - 与当前知识点的关联解释（为何相关、补充了什么）

约束：

- MVP 阶段不做参考库的扫描建模与 RAG 索引
- 后续实现时建议为参考库单独建立索引与 UI 标签页，避免污染主书知识体系

## 8. 失败与降级

- Content Agent 失败：
  - 只展示原文片段 + 从片段抽取的 3 条要点（简单抽取策略）
- 证据片段缺失：
  - 提示“未找到可靠原文依据”，允许用户通过搜索定位

## 9. 相关文档

- [00-总体设计.md](00-总体设计.md)
- [01-文档扫描与知识体系构建.md](01-文档扫描与知识体系构建.md)
- [02-知识点浏览与搜索.md](02-知识点浏览与搜索.md)
- [05-数据模型与存储策略（MVP）.md](05-数据模型与存储策略（MVP）.md)

