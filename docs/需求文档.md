# Research-Learning 模块功能需求文档

## 1. 项目目标

基于书籍文档的智能学习系统，输入为指定目录中的一组 .md 文档。
系统利用 Agent 对文档进行扫描，建立知识体系，提取知识点，并为选定章节生成学习内容与练习题。
通过 RAG、知识图谱、Agent 自适应学习等技术，提供从“知识获取”到“练习巩固”的学习体验。

### 核心范围说明

- **单书籍学习**：专注于单本书/单目录的学习体验。
- **使用过程**：
  - **预处理阶段**：扫描书籍章节，分段落，数据存储到单独文件。
  - **数据生成阶段**：基于扫描结果生成知识点、PPT、TTS描述、知识图谱、知识体系，所有数据与段落关联。
  - **学习阶段**：左侧章节树导航，右侧PPT形式学习界面，包含口语教案和习题。

## 2. 核心功能需求

### 2.1 预处理阶段（章节扫描与段落切分）

- **输入处理**：程序启动时扫描指定书籍目录中的 .md 文档，支持增量更新。
- **章节解析**：识别文档的标题层级，构建章节树结构。
- **段落切分**：将每个章节内容切分为段落块，保留段落的位置信息（filePath + 标题路径 + 段落/行号范围）。
- **数据存储**：预处理结果存储为单独的文件，包含章节树、段落块及其位置信息，方便后续数据生成和学习阶段使用。

### 2.2 数据生成阶段（与段落关联的知识产品）

在预处理完成后，系统基于段落块生成以下知识产品，所有数据都与段落直接关联：

- **知识点提取**：从段落中提取核心术语、定义或概念，每个知识点关联到对应的段落块。
- **知识体系构建**：基于章节树和知识点，建立层次化的知识体系，知识点间的关系（父子、关联、依赖等）。
- **知识图谱构建**：将知识点转换为知识图谱节点，保留其类型、重要性、章节路径等属性，计算节点间的关系权重。
- **PPT内容生成**：为每个章节生成教学PPT，PPT内容基于章节段落原文、知识点信息和知识点关系，分为多个部分逐个生成。
- **TTS口播说明**：为每个PPT页面生成匹配的口语教案，用于对接TTS（文本转语音）功能，提供音频讲解。

### 2.3 UI界面设计

- **界面布局（左右分栏）**：
  - **左侧导航**：章节树列表，按照扫描后的树形结构展示，支持点击导航。
  - **右侧主区**：交互式幻灯片演示区（HTML Based PPT），支持鼠标滑动翻页。

### 2.4 章节学习界面（PPT教学模式）

用户选择某个章节后，系统在右侧显示该章节的学习界面，以PPT形式呈现：

- **口语教案生成**：基于章节段落原文、知识点信息、知识点关系生成合适的口语化教案，分为多个PPT页面逐个生成。
- **内容组成**：
  - **PPT内容**：每个页面展示教学内容，包含文字、图片、图表等。
  - **口播说明**：每个PPT页面匹配对应的口播说明，对接TTS功能，提供音频讲解。
- **交互方式**：
  - **滑动翻页**：支持鼠标滚轮或点击进行上下/左右翻页。
  - **原文对照**：在关键内容处，可查看对应的原文片段（包含filePath + 标题路径 + 段落/行号范围）。
  - **知识关联**：内容中提及其他知识点时，提供可点击链接，点击后跳转到相关内容。

### 2.5 习题功能

- **习题位置**：习题按钮位于最后一页PPT的右下角。
- **交互方式**：
  - 点击习题按钮后，在当前PPT位置展开习题界面，用户可进行复习和总结。
  - 完成习题后，可选择继续学习下一章。
- **习题类型**：选择题、填空题、简答题等，基于章节内容生成1~3题。
- **习题反馈**：用户作答后，输出反馈与参考答案/要点。

### 2.6 数据模型与存储

- **存储方案**：
  - **预处理数据**：存储为单独的文件，包含章节树、段落块及其位置信息。
  - **知识产品数据**：
    - 知识点、知识体系、知识图谱存储在本地数据库（SQLite）。
    - PPT内容和TTS口播说明存储为文件或数据库记录，与段落块关联。
  - **向量数据**：嵌入式向量数据库（或 SQLite 向量扩展），用于 RAG 检索。
- **架构设计**：采用 Repository 模式隔离存储实现，支持未来扩展。

### 2.7 Agent 编排与技术栈

- **编排框架**：**Semantic Kernel** 全面接管 Agent 编排。
- **实现模式**：
  - **多智能体协作**：Manager 规划学习路径，Tutor 讲解，Examiner 出题，Reviewer 点评。
  - **Plugins/Skills**：
    - `DocumentProcessingPlugin`（预处理与存储）
    - `KnowledgeGraphPlugin`（构建与查询）
    - `ContentGenerationPlugin`（PPT内容与口播说明生成）
    - `AssessmentPlugin`（出题与判卷）
    - `RetrievalPlugin`（RAG）

## 3. 非功能需求

- **性能**：
  - 大文件/多文件扫描需支持后台异步处理，前台展示进度。
  - 向量检索需保证毫秒级响应。
- **可配置性**：支持自定义 Prompt 模板，支持切换不同 LLM 模型（OpenAI, Azure, Local LLM）。
- **鲁棒性**：异常处理机制完善，Agent 生成失败时有明确降级策略（如回退到仅展示原文）。
- **隐私**：默认本地运行，保护用户学习数据。
- **TTS集成**：支持对接主流 TTS 服务（如 Azure TTS、本地 TTS 引擎），提供高质量的音频讲解。

---

**目标**：创建一个功能完备的智能书籍学习系统，通过 Agent 与 RAG 技术实现深度学习、知识内化与能力评估。
